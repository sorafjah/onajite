<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>おなじものをだそう</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation; /* ダブルタップによるズームを無効化 */
        }
        .hand-display {
            font-size: 8rem; /* 絵文字のサイズを大きく */
            line-height: 1;
            user-select: none; /* テキスト選択を無効化 */
            -webkit-user-select: none; /* Safari用 */
            -moz-user-select: none; /* Firefox用 */
            -ms-user-select: none; /* IE用 */
            transition: transform 0.1s ease-out; /* アニメーション用のトランジション */
        }
        .hand-display.pop {
            animation: pop 0.2s ease-out;
        }
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        .game-container {
            width: 100%;
            max-width: 500px; /* 最大幅を設定 */
            margin: auto;
            padding: 1rem;
        }
        .hand-area {
            background-color: #f3f4f6; /* 薄いグレーの背景 */
            border-radius: 0.75rem; /* 角を丸く */
            padding: 2rem;
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px; /* 手の表示エリアの最小の高さを確保 */
            cursor: pointer; /* クリック可能であることを示すカーソル */
        }
        .reset-button {
            background-color: #4f46e5; /* 紫色の背景 */
            color: white;
            font-weight: bold;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.3s;
        }
        .reset-button:hover {
            background-color: #4338ca;
        }
        .tap-count {
            color: #4b5563; /* やや濃いグレーの文字色 */
        }
        .title {
            color: #374151; /* 濃いグレーの文字色 */
            font-weight: bold;
            font-size: 1.875rem; /* Tailwindのtext-3xl相当 */
            margin-bottom: 1.5rem;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-600 to-blue-500 flex flex-col items-center justify-center min-h-screen p-4">

    <div class="bg-white p-6 sm:p-8 rounded-xl shadow-2xl game-container">
        <h1 id="gameTitle" class="title text-center">おなじものをだそう</h1>

        <div id="handArea" class="hand-area">
            <span id="handDisplay" class="hand-display">✌️</span> </div>

        <div class="flex justify-between items-center mt-4">
            <p id="tapCountDisplay" class="tap-count text-lg">タップ回数: 0</p>
            <button id="resetButton" class="reset-button">リセット</button>
        </div>
    </div>

    <script>
        const handDisplay = document.getElementById('handDisplay');
        const tapCountDisplay = document.getElementById('tapCountDisplay');
        const resetButton = document.getElementById('resetButton');
        const handArea = document.getElementById('handArea');
        const gameTitle = document.getElementById('gameTitle');

        // 表示する手の絵文字 (グー, チョキ, パー)
        const hands = ["✊", "✌️", "✋"];
        // サプライズで表示する手の絵文字 (片手でできる形)
        const surpriseHands = ["👌", "👍", "👎", "👈", "👉", "👆", "👇", "👋", "🤙", "🤘", "🤞", "🖖", "🤟"];

        let tapCount = 0;
        let gameActive = true; // ゲームがアクティブかどうか

        // 初期状態を設定
        function initializeGame() {
            handDisplay.textContent = "✌️"; // 初期表示をピースに変更
            handDisplay.classList.remove('pop'); // アニメーションクラスを削除
            tapCount = 0;
            tapCountDisplay.textContent = `タップ回数: ${tapCount}`;
            gameActive = true;
            gameTitle.textContent = "おなじものをだそう";
        }

        // 手をランダムに表示する関数
        function displayRandomHand() {
            if (!gameActive) return;

            tapCount++;
            tapCountDisplay.textContent = `タップ回数: ${tapCount}`;

            // アニメーションクラスを一旦削除して再度追加することで、連続タップでもアニメーションが再生されるようにする
            handDisplay.classList.remove('pop');
            // requestAnimationFrame を挟むことで、クラスの削除と追加が確実に行われるようにする
            requestAnimationFrame(() => {
                requestAnimationFrame(() => { // 2回呼び出すことでより確実性を高める (環境による差異を吸収)
                    handDisplay.classList.add('pop');
                });
            });


            if (tapCount % 10 === 0) {
                // 10回ごとにサプライズ手を表示
                const randomSurpriseIndex = Math.floor(Math.random() * surpriseHands.length);
                handDisplay.textContent = surpriseHands[randomSurpriseIndex];
                gameTitle.textContent = "おなじのできた！？"; // タイトルを変更
            } else {
                // 通常の手をランダムに表示
                const randomIndex = Math.floor(Math.random() * hands.length);
                handDisplay.textContent = hands[randomIndex];
                if (gameTitle.textContent !== "おなじものをだそう") { // サプライズ後ならタイトルを戻す
                    gameTitle.textContent = "おなじものをだそう";
                }
            }
        }

        // リセットボタンの処理
        resetButton.addEventListener('click', () => {
            initializeGame();
        });

        // 手の表示エリアをクリック（タップ）したときの処理
        handArea.addEventListener('click', () => {
            displayRandomHand();
        });

        // アニメーション終了時にクラスを削除するイベントリスナー
        handDisplay.addEventListener('animationend', () => {
            handDisplay.classList.remove('pop');
        });

        // 初期化呼び出し
        // initializeGame(); // HTML側で初期表示を設定したので、ここでは呼ばないか、もしくはHTML側の初期表示と合わせる
                           // 今回はHTML側で初期表示を設定したので、JSでの初期化はそのままにしておきます。
                           // ページ読み込み時に initializeGame を呼び出すことで、JSによる一貫した初期化も可能です。
                           // ここでは、HTMLの初期表示を優先し、リセット時に initializeGame が機能するようにします。
    </script>

</body>
</html>
