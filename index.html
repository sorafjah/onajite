<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- ã‚¿ã‚¤ãƒˆãƒ«ã‚’å¤‰æ›´ -->
    <title>ãŠãªã˜ã¦ã‚’ã ãã†ã‚²ãƒ¼ãƒ </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation; /* ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—ã«ã‚ˆã‚‹ã‚ºãƒ¼ãƒ ã‚’ç„¡åŠ¹åŒ– */
        }
        .hand-display {
            /* æ‰‹ã‚’å¤§ãã 8rem -> 10rem */
            font-size: 10rem; 
            line-height: 1;
            user-select: none; /* ãƒ†ã‚­ã‚¹ãƒˆé¸æŠã‚’ç„¡åŠ¹åŒ– */
            -webkit-user-select: none; /* Safariç”¨ */
            -moz-user-select: none; /* Firefoxç”¨ */
            -ms-user-select: none; /* IEç”¨ */
            transition: transform 0.1s ease-out; /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ */
        }
        .hand-display.pop {
            animation: pop 0.2s ease-out;
        }
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        .game-container {
            width: 100%;
            max-width: 500px; /* æœ€å¤§å¹…ã‚’è¨­å®š */
            margin: auto;
            padding: 1rem;
        }
        .hand-area {
            background-color: #f3f4f6; /* è–„ã„ã‚°ãƒ¬ãƒ¼ã®èƒŒæ™¯ */
            border-radius: 0.75rem; /* è§’ã‚’ä¸¸ã */
            padding: 2rem;
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            /* æ‰‹ã®æ‹¡å¤§ã«ä¼´ã„ã€è¡¨ç¤ºã‚¨ãƒªã‚¢ã®é«˜ã•ã‚’ç¢ºä¿ 200px -> 240px */
            min-height: 240px; 
        }
        /* â–¼â–¼â–¼ ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¤‰æ›´ â–¼â–¼â–¼ */
        .action-button {
            color: white;
            font-weight: bold;
            /* padding: 0.75rem 1.5rem; ã‚’ 1rem (px-4) ã«å¤‰æ›´ */
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            transition: background-color 0.3s;
            white-space: nowrap; /* ãƒ†ã‚­ã‚¹ãƒˆãŒæ”¹è¡Œã—ãªã„ã‚ˆã†ã«æŒ‡å®š */
            /* width ã¨ margin-bottom ã¯Flexboxã§åˆ¶å¾¡ã™ã‚‹ãŸã‚å‰Šé™¤ */
        }
        /* ãƒœã‚¿ãƒ³ã®è‰²ã‚’ bg-teal-500 ã«çµ±ä¸€ */
        .auto-button, .next-button, .reset-button, .speed-button {
            background-color: #14b8a6; /* Tailwind teal-500 */
        }
        .auto-button:hover, .next-button:hover, .reset-button:hover, .speed-button:hover {
            background-color: #0d9488; /* Tailwind teal-600 */
        }
        /* ãƒœã‚¿ãƒ³ç„¡åŠ¹åŒ–ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .action-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .count-display {
            color: #4b5563; /* ã‚„ã‚„æ¿ƒã„ã‚°ãƒ¬ãƒ¼ã®æ–‡å­—è‰² (Tailwind gray-600) */
        }
        .title {
            color: #374151; /* æ¿ƒã„ã‚°ãƒ¬ãƒ¼ã®æ–‡å­—è‰² (Tailwind gray-700) */
            font-weight: bold;
            font-size: 1.875rem; /* Tailwindã®text-3xlç›¸å½“ */
            margin-bottom: 1.5rem;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-600 to-blue-500 flex flex-col items-center justify-center min-h-screen p-4">

    <div class="bg-white p-6 sm:p-8 rounded-xl shadow-2xl game-container">
        <!-- ã‚¿ã‚¤ãƒˆãƒ«ã‚’å‰Šé™¤ -->
        <!-- <h1 id="gameTitle" class="title text-center">ãŠãªã˜ã¦ã‚’ã ãã†</h1> -->
        <div id="handArea" class="hand-area">
            <span id="handDisplay" class="hand-display">âœŒï¸</span>
        </div>

        <div id="gameControls" class="mt-4">
            <p id="countDisplay" class="count-display text-lg text-center mb-4">è¡¨ç¤ºå›æ•°: 0</p>
            <!-- â–¼â–¼â–¼ ãƒœã‚¿ãƒ³ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´ â–¼â–¼â–¼ -->
            <!-- w-1/3 ã‚’ flex-1 ã«æˆ»ã—ã¦ã€å¹…ã‚’æŸ”è»Ÿã«ã™ã‚‹ -->
            <div class="flex w-full gap-2">
                 <!-- ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚’å·¦ã«ç§»å‹• -->
                 <button id="nextButton" class="action-button next-button flex-1">æ¬¡ã¸</button>
                 <!-- ã€Œè‡ªå‹•ã€ãƒœã‚¿ãƒ³ -->
                 <button id="autoButton" class="action-button auto-button flex-1">è‡ªå‹•</button>
                 <!-- ã€Œãƒªã‚»ãƒƒãƒˆã€ãƒœã‚¿ãƒ³ (æœ€åˆã¯hidden) -->
                 <button id="resetButton" class="action-button reset-button flex-1 hidden">ãƒªã‚»ãƒƒãƒˆ</button>
                 <!-- é€Ÿåº¦ãƒœã‚¿ãƒ³ -->
                 <button id="speedToggleButton" class="action-button speed-button flex-1">ã¯ã‚„ã</button>
            </div>
        </div>
    </div>

    <script>
        // DOMè¦ç´ ã®å–å¾—
        const handDisplay = document.getElementById('handDisplay');
        const countDisplay = document.getElementById('countDisplay');
        const resetButton = document.getElementById('resetButton');
        // startButton ã‚’ autoButton ã«å¤‰æ›´
        const autoButton = document.getElementById('autoButton');
        // nextButton ã‚’è¿½åŠ 
        const nextButton = document.getElementById('nextButton');
        // gameTitleElement ã®å‚ç…§ã¯æ®‹ã™ãŒã€æ“ä½œå¯¾è±¡ã‹ã‚‰å¤–ã™
        // const gameTitleElement = document.getElementById('gameTitle');
        const speedToggleButton = document.getElementById('speedToggleButton');


        // å®šæ•°
        const HANDS = ["âœŠ", "âœŒï¸", "âœ‹"]; // é€šå¸¸ã®æ‰‹
        const SURPRISE_HANDS = ["ğŸ‘Œ", "ğŸ‘", "ğŸ‘", "ğŸ‘ˆ", "ğŸ‘‰", "ğŸ‘†", "ğŸ‘‡", "ğŸ‘‹", "ğŸ¤™", "ğŸ¤˜", "ğŸ¤", "ğŸ––", "ğŸ¤Ÿ"]; // ã‚µãƒ—ãƒ©ã‚¤ã‚ºã®æ‰‹
        const INITIAL_HAND_DISPLAY = "âœŒï¸";
        const NORMAL_INTERVAL = 1000; // ãµã¤ã†: 1ç§’
        const FAST_INTERVAL = 500;   // ã¯ã‚„ã„: 0.5ç§’
        const NORMAL_SURPRISE_PAUSE_DURATION = 3000; // ãµã¤ã†ãƒ¢ãƒ¼ãƒ‰ã§ã®ã‚µãƒ—ãƒ©ã‚¤ã‚ºåœæ­¢æ™‚é–“
        const SURPRISE_PROBABILITY = 0.2;

        // ã‚¿ã‚¤ãƒˆãƒ«ãƒ†ã‚­ã‚¹ãƒˆã®å®šæ•°ã‚’å‰Šé™¤ (ã¾ãŸã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ)
        // const APP_INITIAL_TITLE_TEXT = "ãŠãªã˜ã¦ã‚’ã ãã†";
        // const NORMAL_PLAY_TEXT = "ãŠãªã˜ã¦ã‚’ã ãã†";
        // const SURPRISE_PLAY_TEXT = "ãŠãªã˜ã®ã§ããŸï¼ï¼Ÿ";

        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹å¤‰æ•°
        let displayCount = 0;
        let gameStarted = false;
        let autoChangeIntervalId = null;
        let surprisePauseTimeoutId = null;
        let isSurpriseActive = false;
        let currentInterval = NORMAL_INTERVAL;

        // åˆæœŸçŠ¶æ…‹ã‚’è¨­å®šã™ã‚‹é–¢æ•°
        function initializeGame() {
            gameStarted = false;
            isSurpriseActive = false;

            clearInterval(autoChangeIntervalId);
            clearTimeout(surprisePauseTimeoutId);
            autoChangeIntervalId = null;
            surprisePauseTimeoutId = null;

            handDisplay.textContent = INITIAL_HAND_DISPLAY;
            handDisplay.classList.remove('pop');
            displayCount = 0;
            countDisplay.textContent = `è¡¨ç¤ºå›æ•°: ${displayCount}`;
            // gameTitleElement.textContent = APP_INITIAL_TITLE_TEXT; // ã‚¿ã‚¤ãƒˆãƒ«æ“ä½œã‚’å‰Šé™¤

            // ãƒœã‚¿ãƒ³ã®è¡¨ç¤º/éè¡¨ç¤ºã‚’åˆ¶å¾¡
            autoButton.classList.remove('hidden'); // ã€Œè‡ªå‹•ã€ã‚’è¡¨ç¤º
            resetButton.classList.add('hidden');
            speedToggleButton.classList.remove('hidden');
            nextButton.classList.remove('hidden'); // ã€Œæ¬¡ã¸ã€ã‚’è¡¨ç¤º
            nextButton.disabled = false; // ã€Œæ¬¡ã¸ã€ã‚’æœ‰åŠ¹åŒ–
            
            currentInterval = NORMAL_INTERVAL;
            speedToggleButton.textContent = 'ã¯ã‚„ã';
        }

        // æ‰‹ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«è¡¨ç¤ºã—ã€ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ã‚’å‡¦ç†ã™ã‚‹é–¢æ•° (è‡ªå‹•å†ç”Ÿç”¨)
        function changeHand() {
            if (!gameStarted || isSurpriseActive) {
                return;
            }

            displayCount++;
            countDisplay.textContent = `è¡¨ç¤ºå›æ•°: ${displayCount}`;

            handDisplay.classList.remove('pop');
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    handDisplay.classList.add('pop');
                });
            });

            const showSurprise = Math.random() < SURPRISE_PROBABILITY;

            if (showSurprise) {
                const randomSurpriseIndex = Math.floor(Math.random() * SURPRISE_HANDS.length);
                handDisplay.textContent = SURPRISE_HANDS[randomSurpriseIndex];
                // gameTitleElement.textContent = SURPRISE_PLAY_TEXT; // ã‚¿ã‚¤ãƒˆãƒ«æ“ä½œã‚’å‰Šé™¤
                isSurpriseActive = true;

                const surpriseDuration = (currentInterval === FAST_INTERVAL) 
                    ? FAST_INTERVAL 
                    : NORMAL_SURPRISE_PAUSE_DURATION;

                surprisePauseTimeoutId = setTimeout(() => {
                    isSurpriseActive = false;
                }, surpriseDuration);

            } else {
                const randomIndex = Math.floor(Math.random() * HANDS.length);
                handDisplay.textContent = HANDS[randomIndex];
                // gameTitleElement.textContent = NORMAL_PLAY_TEXT; // ã‚¿ã‚¤ãƒˆãƒ«æ“ä½œã‚’å‰Šé™¤
            }
        }

        // ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ç”¨ã®æ‰‹å‹•å¤‰æ›´é–¢æ•° (æ–°è¨­)
        function manualChangeHand() {
            // ã‚µãƒ—ãƒ©ã‚¤ã‚ºè¡¨ç¤ºä¸­ã€ã¾ãŸã¯è‡ªå‹•å†ç”Ÿä¸­ã¯å‹•ä½œã—ãªã„
            if (isSurpriseActive || gameStarted) {
                return;
            }
            
            // ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—ã¨è¡¨ç¤º
            displayCount++;
            countDisplay.textContent = `è¡¨ç¤ºå›æ•°: ${displayCount}`;

            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            handDisplay.classList.remove('pop');
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    handDisplay.classList.add('pop');
                });
            });

            // æ‰‹ã®æ±ºå®šãƒ­ã‚¸ãƒƒã‚¯ï¼ˆchangeHandã‹ã‚‰ã‚³ãƒ”ãƒ¼ï¼‰
            const showSurprise = Math.random() < SURPRISE_PROBABILITY;

            if (showSurprise) {
                const randomSurpriseIndex = Math.floor(Math.random() * SURPRISE_HANDS.length);
                handDisplay.textContent = SURPRISE_HANDS[randomSurpriseIndex];
                // gameTitleElement.textContent = SURPRISE_PLAY_TEXT; // ã‚¿ã‚¤ãƒˆãƒ«æ“ä½œã‚’å‰Šé™¤
                isSurpriseActive = true; // ã‚µãƒ—ãƒ©ã‚¤ã‚ºçŠ¶æ…‹ã«ã™ã‚‹

                // æ‰‹å‹•ãƒ¢ãƒ¼ãƒ‰ã§ã¯é€Ÿåº¦è¨­å®šãŒåæ˜ ã•ã‚Œãªã„ãŸã‚ã€æ¨™æº–ã®åœæ­¢æ™‚é–“ã‚’ä½¿ã†
                const surpriseDuration = NORMAL_SURPRISE_PAUSE_DURATION;

                surprisePauseTimeoutId = setTimeout(() => {
                    isSurpriseActive = false;
                }, surpriseDuration);

            } else {
                const randomIndex = Math.floor(Math.random() * HANDS.length);
                handDisplay.textContent = HANDS[randomIndex];
                // gameTitleElement.textContent = NORMAL_PLAY_TEXT; // ã‚¿ã‚¤ãƒˆãƒ«æ“ä½œã‚’å‰Šé™¤
            }
        }
        
        // ã‚¿ã‚¤ãƒãƒ¼ã‚’é–‹å§‹ã¾ãŸã¯å†é–‹ã™ã‚‹é–¢æ•°
        function startTimer() {
            if (autoChangeIntervalId) clearInterval(autoChangeIntervalId);
            autoChangeIntervalId = setInterval(changeHand, currentInterval);
        }

        // ã€Œè‡ªå‹•ã€ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ (æ—§ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³)
        autoButton.addEventListener('click', () => {
            if (gameStarted) return;

            gameStarted = true;
            // ã€Œè‡ªå‹•ã€ãƒœã‚¿ãƒ³ã‚’éš ã—ã€ã€Œãƒªã‚»ãƒƒãƒˆã€ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
            autoButton.classList.add('hidden');
            resetButton.classList.remove('hidden');
            // ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
            nextButton.disabled = true;

            changeHand();
            startTimer();
        });

        // ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ (æ–°è¨­)
        nextButton.addEventListener('click', () => {
            // è‡ªå‹•å†ç”ŸãŒå§‹ã¾ã£ã¦ã„ãªã„æ™‚ã ã‘å‹•ä½œ
            if (!gameStarted) {
                manualChangeHand();
            }
        });
        
        // é€Ÿåº¦åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        speedToggleButton.addEventListener('click', () => {
            if (currentInterval === NORMAL_INTERVAL) {
                currentInterval = FAST_INTERVAL;
                speedToggleButton.textContent = 'ãµã¤ã†ã«';
            } else {
                currentInterval = NORMAL_INTERVAL;
                speedToggleButton.textContent = 'ã¯ã‚„ã';
            }
            
            // â–¼â–¼â–¼ ã‚²ãƒ¼ãƒ ãŒå§‹ã¾ã£ã¦ã„ã‚‹å ´åˆã€é€Ÿåº¦ã®å¤‰æ›´ã‚’å³æ™‚åæ˜ ã™ã‚‹ â–¼â–¼â–¼
            if (gameStarted) {
                startTimer();
            }
        });

        // ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        resetButton.addEventListener('click', () => {
            initializeGame();
        });

        // popã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã«ã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤ã™ã‚‹
        handDisplay.addEventListener('animationend', () => {
            handDisplay.classList.remove('pop');
        });

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ã‚²ãƒ¼ãƒ ã‚’åˆæœŸåŒ–
        initializeGame();
    </script>

</body>
</html>


